#set document(
  title: "پروتکل ZELDHASH",
  author: "Ouziel Slama"
)
#set page(
  paper: "a4",
  margin: (x: 2.5cm, y: 2.5cm),
  numbering: "1",
)
#set par(justify: true, leading: 0.65em)
#set heading(numbering: "1.1")
#show heading: it => [
  #it
  #v(0.8em)
]

#align(center)[
  #text(size: 24pt, weight: "bold")[پروتکل ZELDHASH]
]
#align(center)[
  #text(size: 14pt)[*شکار نادرترین تراکنش‌های بیت‌کوین و کسب ZELD*]
]
#align(center)[
  #text(size: 12pt)[نوشته Ouziel Slama]
]

#v(2em)

= انگیزه‌ها

- برای هیجان شکار. هر تراکنش فرصتی برای کشف چیزی نادر می‌شود — گنجی دیجیتال که در دید آشکار روی بلاک‌چین پنهان شده است.

- این الگوهای صفرهای ابتدایی نه تنها نادر هستند — بلکه می‌توانند فشرده‌سازی را نیز بهبود بخشند و به طور بالقوه ذخیره‌سازی بلاک‌چین و کارایی پردازش را بهینه کنند.

- هر کسی می‌تواند با شکار تراکنش‌های نادر ZELD کسب کند — نه مانند استخراج بلوک بیت‌کوین با یک برنده در هر بلوک. شکار برای همه باز است.

- در صورت موفقیت، توکن‌های ZELD می‌توانند در نهایت هزینه‌های تراکنش را بازپرداخت کنند — به شکارچیانی که نادرترین یافته‌ها را کشف می‌کنند پاداش دهند!

= استخراج ZELD

برای استخراج ZELD باید یک تراکنش بیت‌کوین پخش کنید که txid آن با حداقل ۶ صفر شروع شود. پاداش بر اساس مقایسه تراکنش شما با بهترین تراکنش در بلوک محاسبه می‌شود:

- در یک بلوک مشخص، تراکنش‌هایی که با بیشترین صفر شروع می‌شوند ۴۰۹۶ ZELD کسب می‌کنند

- تراکنش‌هایی با یک صفر کمتر از بهترین تراکنش‌ها ۴۰۹۶/۱۶ یا ۲۵۶ ZELD کسب می‌کنند

- تراکنش‌هایی با دو صفر کمتر ۴۰۹۶ / ۱۶ / ۱۶ یا ۱۶ ZELD کسب می‌کنند

- و غیره.

بنابراین فرمول استفاده شده به شرح زیر است:

#align(center)[
  ```
  reward = 4096 / 16 ^ (max_zero_count - zero_count)
  ```
]

که در آن `max_zero_count` برابر با تعداد صفرهایی است که بهترین تراکنش را شروع می‌کنند و `zero_count` تعداد صفرهایی است که تراکنشی را که پاداش آن را محاسبه می‌کنیم شروع می‌کنند.

*توجه:* تراکنش‌های Coinbase واجد شرایط پاداش ZELD نیستند.

= توزیع ZELD

ZELDهای کسب شده با تراکنشی که با ۶ صفر یا بیشتر شروع می‌شود به UTXOها توزیع می‌شوند. توزیع به شرح زیر انجام می‌شود:

- اگر یک UTXO غیر-OP_RETURN وجود داشته باشد، کل پاداش را دریافت می‌کند.

- اگر دو یا بیشتر UTXO غیر-OP_RETURN وجود داشته باشد، پاداش به همه UTXOها به جز آخری، به نسبت ارزش هر UTXO توزیع می‌شود

- از آنجا که محاسبات فقط با اعداد صحیح انجام می‌شود، باقیمانده احتمالی تقسیم به اولین UTXO غیر-OP_RETURN توزیع می‌شود.

به عنوان مثال، اگر تراکنشی که ۲۵۶ ZELD کسب می‌کند شامل ۴ خروجی با ۵۰۰، ۵۰۰، ۵۰۰ و ۲۰۰۰ ساتوشی باشد، خروجی اول ۸۶ ZELD از پاداش دریافت می‌کند، دومی و سومی ۸۵ ZELD.

= انتقال ZELD

وقتی UTXOهایی با ZELD پیوست شده خرج می‌شوند، ZELDها به UTXOهای جدید در تراکنش توزیع می‌شوند. دو روش برای توزیع ZELD هنگام انتقال آنها وجود دارد:

== روش ۱: توزیع نسبی خودکار

به طور پیش‌فرض، توزیع دقیقاً به همان روش پاداش‌ها انجام می‌شود — به نسبت بر اساس ارزش بیت‌کوین UTXOهای خروجی، به استثنای آخرین خروجی اگر چندین خروجی وجود داشته باشد.

== روش ۲: توزیع سفارشی از طریق OP_RETURN

می‌توانید دقیقاً مشخص کنید که ZELDها چگونه باید توزیع شوند با اضافه کردن یک خروجی OP_RETURN در تراکنش خود با داده‌های توزیع سفارشی. این امکان کنترل دقیق بر انتقالات ZELD را فراهم می‌کند.

=== فرمت OP_RETURN:

- اسکریپت OP_RETURN باید شامل داده‌هایی باشد که با پیشوند ۴ بایتی "ZELD" شروع می‌شود

- پس از پیشوند، داده‌ها باید در فرمت CBOR کدگذاری شوند

- داده CBOR باید یک بردار از اعداد صحیح ۶۴ بیتی بدون علامت (Vec<u64>) را نشان دهد

- هر عدد صحیح مشخص می‌کند که چند ZELD به UTXO خروجی مربوطه ارسال شود

=== قوانین توزیع:

- تعداد مقادیر در آرایه توزیع به طور خودکار تنظیم می‌شود تا با تعداد خروجی‌های غیر-OP_RETURN مطابقت داشته باشد

- اگر آرایه خیلی بلند باشد، مقادیر اضافی حذف می‌شوند

- اگر آرایه خیلی کوتاه باشد، صفرها اضافه می‌شوند

- مجموع کل مقادیر توزیع نمی‌تواند از کل ZELDهای در حال خرج شدن بیشتر باشد

- اگر مجموع کمتر از کل باشد، تفاوت به اولین خروجی اضافه می‌شود

- اگر مجموع از کل بیشتر شود، تراکنش به توزیع نسبی برمی‌گردد

- پاداش‌های ZELD تازه استخراج شده همیشه به صورت نسبی توزیع می‌شوند و سپس با توزیع سفارشی ترکیب می‌شوند

=== مثال:

اگر ۱۰۰۰ ZELD برای توزیع در ۳ خروجی دارید و می‌خواهید ۶۰۰ به اولی، ۳۰۰ به دومی و ۱۰۰ به سومی بفرستید، OP_RETURN شما شامل "ZELD" و سپس کدگذاری CBOR از [600, 300, 100] خواهد بود.

*نکات:*
- اگر هیچ توزیع OP_RETURN معتبری یافت نشود، تراکنش به طور خودکار از روش توزیع نسبی استفاده می‌کند.
- اگر تراکنش فقط شامل یک خروجی OP_RETURN باشد، هر ZELD پیوست شده به ورودی‌های تراکنش #strong[و هر پاداش تازه کسب شده] برای همیشه سوزانده می‌شود زیرا هیچ خروجی قابل خرج برای دریافت آنها وجود ندارد.
- هنگامی که چندین خروجی OP_RETURN وجود دارد، فقط آنکه آخرین بار در تراکنش ظاهر می‌شود و payload معتبر `ZELD`+CBOR را حمل می‌کند برای توزیع در نظر گرفته می‌شود.

